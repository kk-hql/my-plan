<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªå¾‹è®¡åˆ’ & å†å²è¿½è¸ª</title>
    <style>
        :root {
            --primary: #4a90e2;
            --success: #52c41a;
            --danger: #ff4d4f;
            --bg: #f0f2address5;
        }

        body { font-family: sans-serif; background: var(--bg); margin: 0; padding: 15px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 450px; }
        
        /* æ—¥å†éƒ¨åˆ† */
        .history-section { background: white; border-radius: 15px; padding: 15px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .history-title { font-size: 0.9rem; color: #666; margin-bottom: 10px; font-weight: bold; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .day-dot { 
            aspect-ratio: 1; border-radius: 4px; background: #e0e0e0; 
            font-size: 10px; display: flex; align-items: center; justify-content: center; color: white;
        }
        .day-dot.completed { background-color: var(--success); }
        .day-dot.failed { background-color: var(--danger); }
        .day-dot.today { border: 2px solid var(--primary); color: #333; }

        /* ä»»åŠ¡éƒ¨åˆ† */
        .task-list { background: white; border-radius: 15px; padding: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .task-item { 
            display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #eee;
            transition: background 0.2s;
        }
        .task-item:last-child { border-bottom: none; }
        .checkbox { width: 22px; height: 22px; border: 2px solid #ddd; border-radius: 50%; margin-right: 12px; flex-shrink: 0; }
        .done .checkbox { background: var(--success); border-color: var(--success); position: relative; }
        .done .checkbox::after { content: 'âœ“'; color: white; position: absolute; left: 5px; top: -1px; font-size: 14px; }
        .task-info b { display: block; font-size: 1rem; }
        .task-info span { font-size: 0.8rem; color: #888; }
        .done .task-info b { text-decoration: line-through; color: #bbb; }

        h2 { color: var(--primary); font-size: 1.2rem; margin: 10px 0; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ—“ï¸ å†å²ç»Ÿè®¡</h2>
    <div class="history-section">
        <div class="history-title">æœ€è¿‘ 28 å¤©è¡¨ç° (ç»¿:å…¨è¾¾æˆ, çº¢:æœ‰é—æ¼)</div>
        <div class="calendar-grid" id="calendar"></div>
    </div>

    <h2>ğŸ”¥ ä»Šæ—¥ä»»åŠ¡</h2>
    <div class="task-list" id="taskList"></div>
    
    <p style="text-align: center; color: #999; font-size: 0.7rem; margin-top: 20px;">
        æ•°æ®ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨ï¼Œæ¸…é™¤ç¼“å­˜ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±
    </p>
</div>

<script>
    const tasks = [
        { t: "08:00", title: "èµ·åºŠ+é«˜è›‹ç™½æ—©é¤", note: "é¸¡è›‹/ç‰›å¥¶" },
        { t: "09:00", title: "æ·±åº¦å­¦ä¹  (Deep Work)", note: "ä¸“æ³¨æ”»å…‹ä»£ç " },
        { t: "12:00", title: "åˆé¤+åˆç¡", note: "å¿…é¡»ä¼‘æ¯20åˆ†é’Ÿ" },
        { t: "14:00", title: "å¥èº«/ä½“æ€è®­ç»ƒ", note: "æ— æ°§+æœ‰æ°§" },
        { t: "16:00", title: "é¡¹ç›®å®æˆ˜/è°ƒBug", note: "ä¿®ä¿®è¡¥è¡¥" },
        { t: "18:00", title: "æ™šé¤+æ•£æ­¥", note: "å¬AIæ’­å®¢" },
        { t: "20:00", title: "ğŸ® æ¸¸æˆæ—¶é—´", note: "ä»Šæ—¥å¥–åŠ±" },
        { t: "22:00", title: "æ´—æ¼±+æ‹‰ä¼¸", note: "çŒ«ç‰›å¼æ”¾æ¾" }
    ];

    const todayStr = new Date().toISOString().split('T')[0];
    let historyData = JSON.parse(localStorage.getItem('my_growth_log')) || {};

    // åˆå§‹åŒ–ä»»åŠ¡åˆ—è¡¨
    function initTasks() {
        const listWrap = document.getElementById('taskList');
        const todayStatus = historyData[todayStr] || [];
        
        listWrap.innerHTML = tasks.map((item, idx) => `
            <div class="task-item ${todayStatus.includes(idx) ? 'done' : ''}" onclick="toggleTask(${idx})">
                <div class="checkbox"></div>
                <div class="task-info">
                    <b>${item.t} ${item.title}</b>
                    <span>${item.note}</span>
                </div>
            </div>
        `).join('');
    }

    // åˆ‡æ¢æ‰“å¡çŠ¶æ€
    function toggleTask(idx) {
        if (!historyData[todayStr]) historyData[todayStr] = [];
        const pos = historyData[todayStr].indexOf(idx);
        
        if (pos > -1) {
            historyData[todayStr].splice(pos, 1);
        } else {
            historyData[todayStr].push(idx);
        }
        
        localStorage.setItem('my_growth_log', JSON.stringify(historyData));
        initTasks();
        renderCalendar();
    }

    // æ¸²æŸ“æ—¥å†å¢™
    function renderCalendar() {
        const cal = document.getElementById('calendar');
        cal.innerHTML = '';
        const now = new Date();
        
        for (let i = 27; i >= 0; i--) {
            const d = new Date();
            d.setDate(now.getDate() - i);
            const dateKey = d.toISOString().split('T')[0];
            const dayStatus = historyData[dateKey] || [];
            
            let statusClass = '';
            if (dayStatus.length === tasks.length) {
                statusClass = 'completed'; // å…¨éƒ¨å®Œæˆ -> ç»¿
            } else if (dayStatus.length > 0) {
                statusClass = 'failed'; // æ²¡åšå®Œ -> çº¢
            } else if (dateKey < todayStr) {
                statusClass = 'failed'; // è¿‡å»çš„æ—¥å­æ²¡æ•°æ® -> çº¢
            }

            if (dateKey === todayStr) statusClass += ' today';

            const dot = document.createElement('div');
            dot.className = `day-dot ${statusClass}`;
            dot.innerText = d.getDate();
            cal.appendChild(dot);
        }
    }

    initTasks();
    renderCalendar();
</script>

</body>
</html>